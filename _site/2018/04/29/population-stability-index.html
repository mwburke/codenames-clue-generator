<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Population Stability Index - Works of Chart</title>
    <meta name="author"  content="Matthew Burke">
    <meta name="description" content="Population Stability Index">
    <meta name="keywords"  content="python, data-science, ml">
    <!-- Open Graph -->
    <meta property="og:title" content="Population Stability Index - Works of Chart">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://worksofchart.com/2018/04/29/population-stability-index.html">
    <meta property="og:description" content="Making sense of data">
    <meta property="og:site_name" content="Works of Chart">
    <link rel="stylesheet" href="//cdn.staticfile.org/normalize/6.0.0/normalize.min.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_roc50gemkxpw4s4i.css">
    <link rel="stylesheet" href="/assets/css/github-markdown.css">
    <link rel="stylesheet" href="/assets/css/prism.css">
    <link rel="stylesheet" href="/assets/css/share.min.css">
    <link rel="stylesheet" href="/assets/css/app.min.css">
    
    <!--
Author: Ray-Eldath
refer to:
 - http://docs.mathjax.org/en/latest/options/index.html
-->

	<script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
		jax: ["input/TeX", "output/HTML-CSS"],
		tex2jax: {
			inlineMath: [ ["$", "$"] ],
			displayMath: [ ["$$", "$$"] ],
			skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
		},
		"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
      });
    </script>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112640723-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-112640723-1');
    </script>

</head>

<body>
    <!--[if lt IE 10]>
<div class="alert-danger" role="alert">你的浏览器实在太太太旧了，放学别走，升级完浏览器再说！<a target="_blank" class="alert-link" href="http://browsehappy.com">立即升级</a></div>
<![endif]-->
<input id="nm-switch" type="hidden" value="false">

<header class="g-header">
    <div class="g-logo">
      <a href="/"></a>
    </div>
    <i id="menu-toggle" class="iconfont icon-menu"></i>
    <nav class="g-nav">
        <ul>
            
            <li><a href="/">home</a></li>
            
            <li><a href="/tags.html">tags</a></li>
            
            <li><a href="/about.html">about</a></li>
            
        </ul>
    </nav>
</header>


<header class="g-banner post-header post-pattern-circuitBoard bgcolor-default " data-theme="default">
    <div class="post-wrapper">
        <div class="post-tags">
            
            
            <a href="http://worksofchart.com/tags#python" class="post-tag">python</a>
            
            <a href="http://worksofchart.com/tags#data-science" class="post-tag">data-science</a>
            
            <a href="http://worksofchart.com/tags#ml" class="post-tag">ml</a>
            
            
        </div>
        <h1>Population Stability Index</h1>
        <div class="post-meta">
            <span class="post-meta-item"><i class="iconfont icon-author"></i><a href="http://worksofchart.com" target="_blank" rel="author">Matthew</a></></span>
            <time class="post-meta-item" datetime="18-04-29"><i class="iconfont icon-date"></i>29 Apr 2018</time>
        </div>
    </div>
    
    <div class="filter"></div>
    <div class="post-cover" style="background: url('https://raw.githubusercontent.com/mwburke/population-stability-index/master/images/distributions.png') center no-repeat; background-size: cover;">
    
</header>

<div class="post-content">
    
    <h2 class="post-subtitle">Quantifying Population Drift</h2>
    
    <article class="markdown-body">
        <h2 id="what-is-the-population-stability-index-psi">What is the population stability index (PSI)?</h2>

<p>PSI is a measure of how much a population has shifted over time or between two different samples of a population in a single number. It does this by bucketing the two distributions and comparing the percents of items in each of the buckets, resulting in a single number you can use to understand how different the populations are. The common interpretations of the PSI result are:</p>

<ul>
  <li><strong>PSI &lt; 0.1</strong>: no significant population change</li>
  <li><strong>PSI &lt; 0.2</strong>: moderate population change</li>
  <li><strong>PSI &gt;= 0.2</strong>: significant population change</li>
</ul>

<h2 id="how-is-psi-used">How is PSI used?</h2>

<p>There are two different ways PSI can be used to make good decisions in a machine learning model building context:</p>

<h3 id="reactive-re-training-triggers">Reactive Re-training Triggers</h3>

<p>After a deploying a ML model into production, it will continue to provide estimates on the population it was trained on. As the population shifts over time, the estimates become less accurate and relevant to the current population, and monitoring the PSI score from the time of model training to current time can be used as automatic triggers to re-train the model when PSI passes a certain threshold (0.2 for example).</p>

<h3 id="proactive-feature-selection">Proactive Feature Selection</h3>

<p>When choosing features to go into a model, certain features may have a lot of predictive power at the time of training, but if a feature is prone to rapid changes in distribution, it may not be a wise decision to include it in the model or it may prompt more frequent monitoring once deployed. PSI is an easy way to check the volatility of population changes for features by comparing populations for several previous time periods.</p>

<h2 id="example-walkthrough">Example Walkthrough</h2>

<p>Here’s a quick example of walking through the steps of a PSI calculation for two (mostly) normal distributions.</p>

<p><img src="https://raw.githubusercontent.com/mwburke/population-stability-index/master/images/distributions.png" alt="" /></p>

<p>As you can see above, the slightly left-skewed initial population (blue) has flattened out a bit to have more of a flat top of the bell curve in the new population (green). From a visual inspection, it looks as if the population is shifting, but I would like a quantitative way to measure how much the shift is rather than qualitatively guessing how much I should be concerned. PSI is a great way to come up with a single metric to measure this.</p>

<p>To calculate the PSI we first divide the initial population range into 10 buckets (an arbitrary number I chose), and count the number of values in each of those buckets for the initial and new populations, and then divide those by the total values in each population to get the percents in each bucket. As expected, plotting the percents ends up looking like a discretized version of the original chart:</p>

<p><img src="https://raw.githubusercontent.com/mwburke/population-stability-index/master/images/constant_bins_percents.png" alt="" /></p>

<p>From here, we perform the actual PSI calculation for each bucket, and them sum them all up to get the overall PSI values for the distributions.</p>

<h3 id="psi-formula">PSI Formula:</h3>

<p>$
PSI = \sum{}\Big(\big(Actual \% - Expected \%\big) \times ln\big(\dfrac{Actual \%}{Expected \%}\big)\Big)
$</p>

<table>
  <thead>
    <tr>
      <th>Breakpoint Value</th>
      <th>Bucket</th>
      <th>Initial Count</th>
      <th>New Count</th>
      <th>Initial Percent</th>
      <th>New Percent</th>
      <th>PSI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>-2.330642</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0.01</td>
      <td>0.001000</td>
      <td>0.020723</td>
    </tr>
    <tr>
      <td>-1.801596</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>0.01</td>
      <td>0.025000</td>
      <td>0.013744</td>
    </tr>
    <tr>
      <td>-1.272550</td>
      <td>3</td>
      <td>4</td>
      <td>6</td>
      <td>0.04</td>
      <td>0.050000</td>
      <td>0.002231</td>
    </tr>
    <tr>
      <td>-0.743504</td>
      <td>4</td>
      <td>8</td>
      <td>15</td>
      <td>0.08</td>
      <td>0.125000</td>
      <td>0.020083</td>
    </tr>
    <tr>
      <td>-0.214458</td>
      <td>5</td>
      <td>27</td>
      <td>18</td>
      <td>0.27</td>
      <td>0.150000</td>
      <td>0.070534</td>
    </tr>
    <tr>
      <td>0.314588</td>
      <td>6</td>
      <td>22</td>
      <td>23</td>
      <td>0.22</td>
      <td>0.191667</td>
      <td>0.003906</td>
    </tr>
    <tr>
      <td>0.843633</td>
      <td>7</td>
      <td>16</td>
      <td>26</td>
      <td>0.16</td>
      <td>0.216667</td>
      <td>0.017181</td>
    </tr>
    <tr>
      <td>1.372679</td>
      <td>8</td>
      <td>12</td>
      <td>14</td>
      <td>0.12</td>
      <td>0.116667</td>
      <td>0.000094</td>
    </tr>
    <tr>
      <td>1.901725</td>
      <td>9</td>
      <td>6</td>
      <td>9</td>
      <td>0.06</td>
      <td>0.075000</td>
      <td>0.003347</td>
    </tr>
    <tr>
      <td>2.430771</td>
      <td>10</td>
      <td>3</td>
      <td>3</td>
      <td>0.03</td>
      <td>0.025000</td>
      <td>0.000912</td>
    </tr>
  </tbody>
</table>

<h3 id="interpretation">Interpretation:</h3>

<p>We get a final PSI value of <strong>0.153</strong>, which indicates that there’s a chance our population is shifting, and we may want to monitor it going forwards. Of course, this is just one way of calculating PSI by using equal size binning of 10 buckets. If we keep the 10 buckets but change our binning strategy to quantile bins, we end up with a different percent distribution and an overall lower estimate of <strong>0.129</strong>.</p>

<p><img src="https://raw.githubusercontent.com/mwburke/population-stability-index/master/images/percentile_bins_percents.png" alt="" /></p>

<h2 id="final-thoughts">Final Thoughts</h2>

<p>PSI seems to be a metric primarily used in the financial industry, but I think it can have a lot of useful applications in the wider ML community when used widely and consistently.</p>

<h3 id="references">References</h3>

<ul>
  <li>https://www.lexjansen.com/wuss/2017/47_Final_Paper_PDF.pdf</li>
  <li>https://www.listendata.com/2015/05/population-stability-index.html</li>
  <li>https://www.quora.com/What-is-population-stability-index</li>
</ul>

<h3 id="python-implementation">Python Implementation</h3>

<p>Check out my python implementation of PSI and a corresponding python notebook going through the example above at <a href="https://github.com/mwburke/population-stability-index">this repo</a>.</p>

<p>Some assumptions the code makes:</p>

<ul>
  <li>Numpy is the only non-standard library dependency</li>
  <li>Assumes continuous variables (categorical variables are handled differently in PSI)</li>
  <li>Replaces bins in the new population that have 0 count with 0.001 percent to avoid divide by zero errors without affecting overall calculation too much</li>
</ul>

    </article>
    
</div>

<section class="author-detail">
    <section class="post-footer-item author-card">
        <div class="avatar">
            <img src="http://worksofchart.com/assets/img/other-profile.jpg" alt="">
        </div>
        <div class="author-name" rel="author">Matthew Burke</div>
        <div class="bio">
            <p>Data Visualization, Machine Learning, Optimization</p>
        </div>
        
        <ul class="sns-links">
            
            <li>
                <a href="//twitter.com/mattburkeley" target="_blank">
                    <i class="iconfont icon-twitter"></i>
                </a>
            </li>
            
            <li>
                <a href="//www.linkedin.com/in/matthew-burke-data-science" target="_blank">
                    <i class="iconfont icon-linkedin"></i>
                </a>
            </li>
            
            <li>
                <a href="//github.com/mwburke" target="_blank">
                    <i class="iconfont icon-github"></i>
                </a>
            </li>
            
        </ul>
        
    </section>
    <section class="post-footer-item read-next">
        
        <div class="read-next-item">
            <a href="/2018/06/24/stargazer-regression-reporting.html" class="read-next-link"></a>
            <section>
                <span>Stargazer Python Library</span>
                <p>Introducing the Stargazer Python Package:I really like th...</p>
            </section>
            
            <div class="filter"></div>
            <img src="https://i.stack.imgur.com/G0hV4.png" alt="">
            
        </div>
        
        
        <div class="read-next-item">
            <a href="/2017/12/29/jekyll-and-d3.html" class="read-next-link"></a>
            <section>
                <span>Working with Jekyll and D3</span>
                <p>Getting tools to play niceJekyll is a fantastic framework...</p>
            </section>
            
        </div>
        
    </section>
    
</section>

<footer class="g-footer">
    <section>Works of Chart © 2018</section>
    <section>Powered by <a href="//jekyllrb.com">Jekyll</a> | <a href="https://github.com/kaeyleo/jekyll-theme-H2O">Theme H2O</a></section>
</footer>

<script src="/assets/js/social-share.min.js"></script>
<script>
    socialShare('.social-share', {
        sites: ['twitter','linkedin','github'],
        wechatQrcodeTitle: "分享到微信朋友圈",
        wechatQrcodeHelper: '<p>扫码后点击右上角</p><p>将本文分享至朋友圈</p>'
    });
</script>
<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
/*写入自己的disqus信息*/
s.src = 'https://mwburke.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
<script src="/assets/js/prism.js"></script>
<script src="/assets/js/index.min.js"></script>
</body>
</html>
